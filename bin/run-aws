#!/bin/bash

if [ "$#" -eq 0 ] ; then
  echo "Defaulting to dev. Use '$0 prd' for prd or '$0 stg' for stg"
fi

env=${1:-dev}

if [ "${env}" != "prd" ] && [ "${env}" != "stg" ] && [ "${env}" != "dev" ] ; then
  echo "Invalid env $env. Supported environments: prd, stg and dev (default)"
  exit 1
fi


GATEWAY_HOST=api-grpc.${env}.token.io
BANK_HOST=fank-grpc.${env}.token.io

echo "Gateway: ${GATEWAY_HOST}"
echo "Fank: ${BANK_HOST}"

./gradlew \
  -DTOKEN_GATEWAY=${GATEWAY_HOST}:443 \
  -DTOKEN_BANK=${BANK_HOST}:443 \
  -DTOKEN_USE_SSL=true \
  cleanTest check

